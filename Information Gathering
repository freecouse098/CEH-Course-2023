Chapter 3 : Information Gathering Techniques

There is a saying that goes “The more information you have about the target, the more is the
chance of successful exploitation.” Information gathering is the first phase of hacking. In this
phase, we gather as much information as possible regarding the target’s online presence, which
in turn reveal useful information about the target itself. The required information will depend
on whether we are doing a network pentest or a web application pentest. In the case of a network
pentest, our main goal would be to gather information on the network. The same applies to web
application pentests. In this module, we will discuss numerous methods of real-world information
intelligence.

In general, all information gathering techniques can be classified into two main categories:
1. Active information gathering
2. Passive information gathering

Active Information Gathering

In active information gathering, we would directly engage with the target, for example, gathering
information about what ports are open on a particular target, what services they are running, and
what operating system they are using. However, the techniques involving active information gath-
ering would be very noisy at the other end. As they are easily detected by IDS, IPS, and firewalls
and generate a log of their presence, and hence are not recommended sometimes.

Passive Information Gathering

In passive information gathering, we do not directly engage with the target. Instead, we use search
engines, social media, and other websites to gather information about the target. This method
is recommended, since it does not generate any log of presence on the target system. A common
example would be to use LinkedIn, Facebook, and other social networks to gather information
about the employees and their interests. This would be very useful when we perform phishing,
keylogging, browser exploitation, and other client side attacks on the employees.

Sources of Information Gathering
There are many sources of information; the most important ones are as follows:
Social media website
Search engines
Forums
Press releases
People search
Job sites
So let’s discuss some of these sources in detail along with some tools of the trade

# Information Gathering with Whois

As I have mentioned earlier, our goal in the information gathering and enumeration phase is to
gather as much information as possible about the target. Whois holds a huge database that con-
tains information regarding almost every website that is on the web, most common information
are “who owns the website” and “the e-mail of the owner,” which can be used to perform social
engineering attacks.
Whois database is accessible on whois.domaintools.com. It’s also available in BackTrack. but
you would need to issue the following command from BackTrack to enable it:
apt-get install whois
In order to perform a Whois search on a website, you would need to type Whois <domainname>
from the command line:
whois www.techlotips.com
ou can see that it has revealed some interesting information such as the e-mail of the owner
(which I have set to private b/w) and the name servers, which shows that hostagtor.com is hosting
this website. We will learn some effective methods to determine name servers later in this section,
when we will talk about DNS enumeration

# Tracing the Location

You would need to know the IP address of the webserver in order to trace the exact location. There
are several methods to figure it out. We will use the simplest one, that is, the ping command. Ping
command sends icmp echo requests to check if the website is up. It’s used for network trouble-
shooting purposes.
From your command line, type the following: ping www.techlotips.com
So we now know that the IP address of our target is 50.22.81.62. After determining the web-
server’s IP, we can use some online tools to track the exact location of the webserver. One such tool
is IPTracer that is available at http://www.ip-adress.com/ip_tracer/yourip
Just replace your IP with your target’s IP, and it will show you the exact location of the web-
server via Google Maps.

# Traceroute

Traceroute is a very popular utility available in both Windows and Linux. It is used for network
orientation. By network orientation I don’t mean scanning a host for open ports or scanning for
services running on a port. It means to figure out how the network topology, firewalls, load bal-
ancers, and control points, etc. are implemented on the network.
58 ◾ Ethical Hacking and Penetration Testing Guide
A traceroute uses a TTL (time to live) field from the IP header, and it increments the IP packet
in order to determine where the system is. The time to live value decreases every time it reaches a
hop on the network (i.e. router to server is one hop).

There are three different types of traceroutes:

1. ICMP traceroute (which is used in Windows by default)
2. TCP traceroute
3. UDP traceroute

# ICMP Traceroute
Microsoft Windows by default uses ICMP traceroute; however, after a few hops, you will get a
timeout, which indicates that there might be a device like IDS or firewall that is blocking ICMP
echo requests.

# TCP Traceroute
Many devices are configured to block ICMP traceroutes. This is where we try TCP or UDP trac-
eroutes, also known as layer 4 traceroutes. TCP traceroute is by default available in BackTrack. If
you can’t find it, just use the following command:
apt-get install tcptraceroute

Usage
From the command line, you would need to issue the following command:
tcptraceroute www.google.com

# UDP Traceroute
Linux also has a traceroute utility, but unlike Windows, it uses UDP protocol for the traceroute.
In Windows, the command for traceroute is “tracrt”. In, Linux, it’s “tracroute”.

Usage:
traceroute www.target.com

# WhatWeb
Our active information gathering section will not be complete without introducing a tool from
BackTrack. WhatWeb is an all-an-one package for performing active footprinting on a website.
It has more than 900 plug-ins capable of identifying server version, e-mail addresses, and SQL
errors. The tool is available in BackTrack by default in the /pentest/enumeration/web/whatweb
directory.
The usage is pretty simple: you need to type ./whatweb followed by the website name. You can
also scan multiple websites at a time.

Command:
./whatweb slashdot.org reddit.com

# Netcraft
Netcraft contains a huge online database with useful information on websites and can be
used for passive reconnaissance against the target. It is also capable of fingerprinting the
webservers.

# Google Hacking:
Google searches can be more than a treasure for a pentester, if he uses them effectively. With
Google searches, an attacker may be able to gather some very interesting information, includ-
ing passwords, on the target. Google has developed a few search parameters in order to
improve targeted search. However, they are abused by hackers to search for sensitive informa-
tion via Google.

# Google Hacking Database
Google hacking database is set up by the offensive security guys, the ones behind the famous
BackTrack distro. Google hacking database has a list of many Google dorks that could be used to
find usernames, passwords, e-mail list, password hashes, and other important information.
So let’s just ask the website to filter out all the Google dorks related to files that contain pass-
words. From the drop-down menu, select the option “Files containing passwords.” Now, you
would see a list of all the dorks that could be used to find passwords. Let’s try one of them.
Out of all other dorks, filetype:sql inurl:wp-content/backup-* seemed to be really interesting
to me, so I gave it a try on Google. Since MySQL passwords are also backed up with other files,
due to the incorrect permissions, it may reveal some interesting information.
What the above query is asking to SQL files with URL pattern wp-content/backup. Fortunately,
with a little bit of searching. I was able to find a “Wordpress mysql database” of a website exposed
to the public.

# Nslookup
Nslookup is available in both Windows and Linux OS. Let’s say that we want the DNS servers to
return all the mail server records of an organization. We would do the following:
Step 1—Issue the nslookup command from the command prompt.
Step 2—Issue the following command:
set type = mx
Step 3—Next, we would enter the domain.
www.msn.com
The query returned mail servers for msn.com.
We can also ask for all the DNS servers for that domain by using the set type = ns command.
